!function(){"use strict";try{if("undefined"!=typeof document){var e=document.createElement("style");e.appendChild(document.createTextNode(".vue-waterfall{position:relative}.vue-waterfall-slot{position:absolute;margin:0;padding:0;box-sizing:border-box}")),document.head.appendChild(e)}}catch(t){console.error("vite-plugin-css-injected-by-js",t)}}();
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("vue")):"function"==typeof define&&define.amd?define(["exports","vue"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self)["Waterfall-Vue3"]={},e.Vue)}(this,(function(e,t){"use strict";var i=(()=>{function e(e,i,n,l){let o=function(e,t,i,n){let a=0;for(let l=n,o=0;l<i.length&&o<=e;l++)o+=i[l].width*t/i[l].height,a++;return a}(e,i.lineGap,n,l),r=Math.max(o-1,1),u=t(e,i,n,l,o),d=function(e,t,i){return e.cost===1/0&&t.cost===1/0?t.width<i?t:e:t.cost>=e.cost?e:t}(t(e,i,n,l,r),u,e),f=d.height,h=d.width;return 1===d.count&&(h=Math.min(i.singleMaxWidth,e),f=n[l].height*h/n[l].width),{left:a(e,h,i.align),count:d.count,height:f}}function t(e,t,i,n,a){let l=0;for(let r=a-1;r>=0;r--){let e=i[n+r];l+=e.width*t.lineGap/e.height}let o=t.lineGap*e/l;if(o<=t.maxLineGap&&o>=t.minLineGap)return{cost:Math.abs(t.lineGap-o),count:a,width:e,height:o};{let i=l>e?t.minLineGap:t.maxLineGap;return{cost:1/0,count:a,width:l*i/t.lineGap,height:i}}}return{calculate:function(t,i,n,a){let l=t.$el.clientWidth,o=n.length,r=0,u=0;for(;u<o;){let t=e(l,i,n,u);for(let e,i,l=0,o=0;l<t.count;l++)e=n[u+l],i=a[u+l],i.top=r,i.left=t.left+o,i.width=e.width*t.height/e.height,i.height=t.height,o+=i.width;u+=t.count,r+=t.height}t.$el.style.height=r+"px"}}})(),n=(()=>({calculate:function(e,t,i,n){let r=e.$el.clientWidth,u=t.grow,d=u?function(e,t){let i=o(t);return{width:t.map((t=>e*t/i)),count:t.length,left:0}}(r,u):function(e,t){let i,n=e/t.lineGap;if(t.singleMaxWidth>=e)n=1,i=Math.max(e,t.minLineGap);else{let a=t.maxLineGap*~~n>=e,l=t.minLineGap*~~(n+1)<=e;a&&l?(n=Math.round(n),i=e/n):a?(n=~~n,i=e/n):l?(n=~~(n+1),i=e/n):(n=~~n,i=t.maxLineGap),1===n&&(i=Math.min(e,t.singleMaxWidth),i=Math.max(i,t.minLineGap))}return{width:l(i,n),count:n,left:a(e,i*n,t.align)}}(r,t),f=l(0,d.count);i.forEach(((e,i)=>{let a=f.reduce(((e,t,i)=>t<f[e]?i:e),0),l=d.width[a%d.count],r=n[i];r.top=f[a],r.left=d.left+(a?o(d.width.slice(0,a)):0),r.width=l,r.height=e.height*(t.fixedHeight?1:l/e.width),f[a]=f[a]+r.height})),e.$el.style.height=Math.max.apply(Math,f)+"px"}}))();function a(e,t,i){switch(i){case"right":return e-t;case"center":return(e-t)/2;default:return 0}}function l(e,t){let i="function"==typeof e?()=>e():()=>e,n=[];for(let a=0;a<t;a++)n[a]=i();return n}function o(e){return e.reduce(((e,t)=>e+t))}const r="_wfMoveClass",u={__name:"Waterfall",props:{autoResize:{type:Boolean,default:!0},interval:{default:200,validator:e=>e>=0},align:{default:"left",validator:e=>~["left","right","center"].indexOf(e)},line:{default:"v",validator:e=>~["v","h"].indexOf(e)},lineGap:{required:!0,validator:e=>e>=0},minLineGap:{validator:e=>e>=0},maxLineGap:{validator:e=>e>=0},singleMaxWidth:{validator:e=>e>=0},grow:{validator:e=>e instanceof Array},fixedHeight:{default:!1},watch:{default:()=>({})}},setup(e){const a=e,l=t.ref(),o=t.getCurrentInstance(),u=t.ref([]),d=t.ref();function f(){var e;if(!o.proxy.$el)return;let t=o.proxy.$el.clientWidth,i=Array.from(null==(e=l.value)?void 0:e.children).map((e=>e.__vueParentComponent.exposed.getMeta()));i.sort(((e,t)=>e.order-t.order)),u.value=i.map((()=>({}))),s(o.proxy,i,u.value),setTimeout((()=>{var e;e=o.proxy.$el,t!==e.clientWidth&&s(o.proxy,i,u.value),o.proxy.$el.style.overflow="hidden",function(e,t){let i=t.filter((e=>e.moveClass)),n=h(i);!function(e,t){e.forEach(((e,i)=>{let n=t[i].node.style;t[i].vm._.exposed.rect.value=e;for(let t in e)n[t]=e[t]+"px"}))}(e,t);let a=h(i);i.forEach(((e,t)=>{e.node[r]=e.moveClass,function(e,t,i){let n=t.left-i.left,a=t.top-i.top,l=t.width/i.width,o=t.height/i.height;e.style.transform=e.style.WebkitTransform=`translate(${n}px,${a}px) scale(${l},${o})`,e.style.transitionDuration="0s"}(e.node,n[t],a[t])})),document.body.clientWidth,i.forEach((e=>{var t;!function(e,t){if(!function(e,t){return new RegExp("\\b"+t+"\\b").test(g(e,"class"))}(e,t)){let i=g(e,"class").trim();g(e,"class",(i+" "+t).trim())}}(e.node,e.moveClass),(t=e.node).style.transform=t.style.WebkitTransform="",t.style.transitionDuration=""}))}(u.value,i),y=!0,o.proxy.$emit("reflowed",o.proxy)}),0)}t.provide("reflow",f),t.watch([()=>a.align,()=>a.line,()=>a.lineGap,()=>a.minLineGap,()=>a.maxLineGap,()=>a.singleMaxWidth,()=>a.fixedHeight,()=>a.watch],(()=>{p()}),{immediate:!0}),t.watch(a.grow,(()=>{p()}),{immediate:!0});function h(e){return e.map((e=>e.vm._.exposed.rect.value))}function s(e,t,a){let l=function(e){const t=e.maxLineGap?+e.maxLineGap:e.lineGap;return{align:~["left","right","center"].indexOf(e.align)?e.align:"left",line:~["v","h"].indexOf(e.line)?e.line:"v",lineGap:+e.lineGap,minLineGap:e.minLineGap?+e.minLineGap:e.lineGap,maxLineGap:t,singleMaxWidth:Math.max(e.singleMaxWidth||0,t),fixedHeight:!!e.fixedHeight,grow:e.grow&&e.grow.map((e=>+e))}}(e);("h"===e.line?i:n).calculate(e,l,t,a)}function c(e){!1!==e&&a.autoResize?w(window,"resize",p,!1):x(window,"resize",p,!1)}function p(){clearTimeout(d.value),d.value=setTimeout(f,a.interval)}function m(e){let t=e.target,i=t[r];i&&function(e,t){let i=new RegExp("\\s*\\b"+t+"\\b\\s*","g"),n=g(e,"class").replace(i," ").trim();g(e,"class",n)}(t,i)}function g(e,t,i){if(void 0===i)return e.getAttribute(t)||"";e.setAttribute(t,i)}function v(){return void 0===window.ontransitionend&&void 0!==window.onwebkittransitionend?"webkitTransitionEnd":"transitionend"}function w(e,t,i,n=!1){e.addEventListener(t,i,n)}function x(e,t,i,n=!1){e.removeEventListener(t,i,n)}let y=!0;return t.onMounted((()=>{t.watch(a.autoResize,((e,t)=>{c(e)}),{immediate:!0}),w(o.proxy.$el,v(),m,!0),c(a.autoResize);const e=new MutationObserver((e=>{e.forEach((e=>{y&&(y=!1,f())}))}));l.value&&e.observe(l.value,{childList:!0,subtree:!1,attributes:!1}),t.onUnmounted((()=>e.disconnect()))})),t.onBeforeUnmount((()=>{c(!1),x(o.proxy.$el,v(),m,!0)})),(e,i)=>(t.openBlock(),t.createElementBlock("div",{class:"vue-waterfall",ref_key:"waterfallRef",ref:l},[t.renderSlot(e.$slots,"default")],512))}},d={__name:"WaterfallSlot",props:{width:{type:Number,required:!0,validator:e=>e>=0},height:{type:Number,required:!0,validator:e=>e>=0},order:{type:Number,default:0},moveClass:{type:String,default:""}},setup(e,{expose:i}){const n=t.getCurrentInstance(),a=e,l=t.ref(!1),o=t.ref(null),r=t.ref({top:0,left:0,width:0,height:0}),u=t.inject("reflow"),d=()=>{u()};t.watch([()=>a.width,()=>a.height],(()=>{d()}));return t.onMounted((()=>{l.value=!0})),t.onUnmounted((()=>{d()})),i({getMeta:()=>({vm:n.proxy,node:o.value,order:a.order,width:a.width,height:a.height,moveClass:a.moveClass}),rect:r}),(e,i)=>t.withDirectives((t.openBlock(),t.createElementBlock("div",{class:"vue-waterfall-slot",ref_key:"node",ref:o},[t.renderSlot(e.$slots,"default")],512)),[[t.vShow,l.value]])}},f={Waterfall:u,WaterfallSlot:d};e.Waterfall=u,e.WaterfallSlot=d,e.default=f,Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
